# device/hp/phobos/sepolicy/init.te

# --- Declarações de tipos necessários ---

# Domínio para binários vendor_exec
type vendor_init, domain;

# (Opcional) Se você quiser declarar o exec_type para vendor_exec:
# type vendor_exec, exec_type, file_type;

# Domínio shell já deve existir; caso contrário, declare:
# type shell, domain;
# type shell_exec, exec_type, file_type;

# zygote_exec já vem do file_contexts, mas se quiser garantir:
# type zygote_exec, exec_type, file_type;

# --- Transições de domínio para execuções feitas por init ---

# Quando init executa um binário rotulado vendor_exec, passe para vendor_init
type_transition init vendor_exec:process vendor_init;

# Quando init executa um binário rotulado shell_exec, passe para shell
type_transition init shell_exec:process shell;

# Quando init executa um binário rotulado zygote_exec (/system/bin/app_process32),
# passe para system_app
#type_transition init zygote_exec:process system_app;

# --- Permissões adicionais de init ---

# (Opcional) Permitir init usar a capability sys_module, caso seu init carregue módulos
allow init self:capability sys_module;

